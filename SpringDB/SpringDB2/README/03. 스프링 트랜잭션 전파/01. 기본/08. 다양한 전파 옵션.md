# 스프링 트랜잭션 전파 - 다양한 전파 옵션
- 스프링은 다양한 트랜잭션 전파 옵션을 제공. 전파 옵션 별도 설정 x -> `REQUIRED` 기본 설정
- 실무에서는 대부분 `REQUIRED` 사용. 아주 가끔 `REQUIRES_NEW`. 나머지는 잘 사용 X

## REQUIRED
가장 많이 사용하는 기본 설정. 기존 트랜잭션이 없으면 생성하고, 있으면 참여한다. <br>
트랜잭션이 필수라는 의미로 이해하면 된다. (필수이기 때문에 없으면 만들고, 있으면 참여)
- 기존 트랜잭션 없음 : 새로운 트랜잭션을 생성한다.
- 기존 트랜잭션 있음 : 기존 트랜잭션에 참여한다.

## REQUIRES_NEW
항상 새로운 트랜잭션을 생성
- 기존 트랜잭션 없음 : 새로운 트랜잭션을 생성한다.
- 기존 트랜잭션 있음 : 새로운 트랜잭션을 생성한다.

## SUPPORT
트랜잭션을 지원한다는 뜻. 기존 트랜잭션이 없으면 없는대로 진행, 있으면 참여한다.
- 기존 트랜잭션 없음 : 트랜잭션 없이 진행된다.
- 기존 트랜잭션 있음 : 기존 트랜잭션에 참여한다.

## NOT_SUPPORT
트랜잭션을 지원하지 않는다는 의미이다.
- 기존 트랜잭션 없음 : 트랜잭션 없이 진행한다.
- 기존 트랜잭션 있음 : 트랜잭션 없이 진행한다. (기존 트랜잭션은 보류한다.)

## MANDATORY
의무사항이다. 트랜잭션이 반드시 있어야 한다. 기존 트랜잭션이 없으면 예외가 발생한다.
- 기존 트랜잭션 없음 : `IllegalTransactionStateException` 예외 발생
- 기존 트랜잭션 있음 : 기존 트랜잭션에 참여한다.

## NEVER
트랜잭션을 사용하지 않는다는 의미이다. 기존 트랜잭션이 있으면 예외 발생. 기존 트랜잭션도 허용하지
않는 강한 부정의 의미로 이해하면 된다.
- 기존 트랜잭션 없음 : 트랜잭션 없이 진행한다.
- 기존 트랜잭션 있음 : `IllegalTransactionStateException` 예외 발생

## NESTED
- 기존 트랜잭션 없음 : 새로운 트랜잭션을 생성한다.
- 기존 트랜잭션 있음 : 중첩 트랜잭션을 만든다.
  - 중첩 트랜잭션은 외부 트랜잭션의 영향을 받지만, 중첩 트랜잭션은 외부에 영향을 주지 않는다.
  - 중첩 트랜잭션이 롤백 되어도 외부 트랜잭션은 커밋할 수 있다.
  - 외부 트랜잭션이 롤백 되면 중첩 트랜잭션도 함께 롤백된다.
- 참고
  - JDBC savepoint 기능을 사용한다. DB 드라이버에서 해당 기능을 지원하는지 확인 필요
  - 중첩 트랜잭션은 JPA에서는 사용할 수 없다.

### 트랜잭션 전파와 옵션
- `isolation`, `timeout`, `readOnly`는 트랜잭션이 처음 시작될 때만 적용된다. 트랜잭션이
참여하는 경우에는 적용되지 않는다.
- 예를 들어서 `REQUIRED`를 통한 트랜잭션 시작, `REQUIRES_NEW`를 통한 트랜잭션 시작 시점에만
적용된다.
